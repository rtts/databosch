{% extends 'rauwkost/base.html' %}
{% load static thumbnail %}
{% load embed_video_tags %}

{% block main %}
  {% for program in programs %}
    <div class="program_container">
      <div class="program color{{program.location.color}}">

        {% if program.video %}
          <div class="video">
            <div class="iframe">
              {% video program.video '800x600' %}
            </div>
          </div>
        {% else %}
          <div class="image">
            {% if program.photos.all.0 %}
              <img src="{% thumbnail program.photos.all.0.image 400x400 %}" alt="{{program.title}}">
            {% endif %}
          </div>
        {% endif %}

        <div class="circles">
          <div class="location color{{program.location.color}}">
            {% if program.location.icon %}
              <img src="{% thumbnail program.location.icon 64x64 %}" alt="{{program.location.name}}">
            {% endif %}
          </div>
          <div class="type color{{program.location.color}}">
            {% if program.type.icon %}
              <img src="{% thumbnail program.type.icon 64x64 %}" alt="{{program.type.name}}">
            {% endif %}
          </div>
          <div class="time color{{program.location.color}}">
            <span>
              {{program.begin}}
            </span>
          </div>
        </div>
        <div class="text">
          <h2>{{program.title}}</h2>
          {{program.short_description}}
        </div>
      </div>
    </div>
  {% endfor %}
{% endblock %}

{% block extrabody %}
  <script src="{% static 'jquery.min.js' %}"></script>
  <script src="{% static 'rauwkost/imagesloaded.pkgd.min.js' %}"></script>
  <script src="{% static 'rauwkost/masonry.pkgd.min.js' %}"></script>
  <script>
    $(function() {
        var $grid = $('main').masonry({
            itemSelector: '.program_container',
        });
        $grid.masonry('layout');
        $grid.imagesLoaded().progress(function() {
            $grid.masonry('layout');
        });
    });
  </script>
{% endblock %}
