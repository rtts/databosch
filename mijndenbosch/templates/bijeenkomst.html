{% extends 'base_with_sidebar.html' %}

{% block sidebar %}
  <div class="spacer"></div>
  {% for m in messages %}
    <div class="message">{{m}}</div>
  {% endfor %}
  <form method="POST">{% csrf_token %}
    {{form.as_p}}
    <div class="spacer"></div>
    <input type="submit" value="Ik doe mee!">
  </form>
  <p>
    Bovenstaande gegevens worden beschikbaar gesteld aan {{netwerkhouder.voornaam}}, de netwerkhouder van "{{naam}}".<br>
    {% if netwerkhouder.email %}
      Heb je nog vragen? <a href="mailto:{{netwerkhouder.email}}">Stuur een e-mail aan {{netwerkhouder.voornaam}}</a>.
    {% endif %}
  </p>
  <h3>{{netwerkhouder}}</h3>
  {% if netwerkhouder.profielfoto %}
    <img width="100%" src="{{netwerkhouder.profielfoto.url}}">
  {% else %}
    (we hebben helaas geen foto van {{netwerkhouder.voornaam}})
  {% endif %}
{% endblock %}

{% block content %}

  {% if bijeenkomst.datum %}
    <h1>{{bijeenkomst.datum}}</h1>
  {% else %}
    <h1>Datum onbekend</h1>
  {% endif %}
  <h2>De bijeenkomst van “{{naam}}”</h2>

  {{bijeenkomst.beschrijving|safe}}

  {% if bijeenkomst.locatie %}
    <h3 style="text-align:right">Locatie: {{bijeenkomst.locatie}}</h3>
    <address>{{bijeenkomst.adres}}</address>
  {% endif %}
{% endblock %}

{% block extrascript %}
<script>
  $(function(){
      $("address").each(function(){
          var apikey = 'AIzaSyBwQf9yfznNycaXoUV4HCAlpUyZIIOHr8Q';
          var source = 'https://www.google.com/maps/embed/v1/place?q=' + encodeURIComponent($(this).text()) + '&key=' + apikey;
          var embed = '<iframe width="100%" height="400" style="border:none" src="' + source +'"></iframe>';
          console.log(embed);
          $(this).html(embed);
      });
  });
</script>
{% endblock %}
